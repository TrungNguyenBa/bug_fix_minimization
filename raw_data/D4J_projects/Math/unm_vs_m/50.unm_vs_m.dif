2c2
< index c781a90..e47d982 100644
---
> index c781a9011..b3a23a1d4 100644
5c5,6
< @@ -184,6 +184,10 @@ public abstract class BaseSecantSolver
---
> @@ -183,7 +183,14 @@ public abstract class BaseSecantSolver
>                      f0 *= f1 / (f1 + fx);
8c9
<                      // Nothing.
---
> -                    // Nothing.
10c11,15
< +                        x0 = 0.5 * (x0 + x1 - FastMath.max(rtol * FastMath.abs(x1), atol));
---
> +                        final double delta = FastMath.max(rtol * FastMath.abs(x1),
> +                                                          atol);
> +                        // Update formula cannot make any progress: Update the
> +                        // search interval.
> +                        x0 = 0.5 * (x0 + x1 - delta);
15a21,41
> diff --git a/src/test/java/org/apache/commons/math/analysis/solvers/RegulaFalsiSolverTest.java b/src/test/java/org/apache/commons/math/analysis/solvers/RegulaFalsiSolverTest.java
> index fea0abcc8..df729f7b6 100644
> --- a/src/test/java/org/apache/commons/math/analysis/solvers/RegulaFalsiSolverTest.java
> +++ b/src/test/java/org/apache/commons/math/analysis/solvers/RegulaFalsiSolverTest.java
> @@ -18,7 +18,6 @@
>  package org.apache.commons.math.analysis.solvers;
>  
>  import org.apache.commons.math.analysis.UnivariateRealFunction;
> -import org.apache.commons.math.exception.TooManyEvaluationsException;
>  import org.junit.Test;
>  import org.junit.Assert;
>  
> @@ -41,7 +40,7 @@ public final class RegulaFalsiSolverTest extends BaseSecantSolverAbstractTest {
>          return new int[] {3, 7, 8, 19, 18, 11, 67, 55, 288, 151, -1};
>      }
>  
> -    @Test(expected=TooManyEvaluationsException.class)
> +    @Test
>      public void testIssue631() {
>          final UnivariateRealFunction f = new UnivariateRealFunction() {
>                  /** {@inheritDoc} */
